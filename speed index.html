<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Neuro Reaction Challenge</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#050505;
  color:#fff;
  text-align:center;
}

h1{
  color:#00ffcc;
  letter-spacing:2px;
}

.panel{
  max-width:500px;
  margin:auto;
  padding:20px;
}

input{
  padding:10px;
  margin:5px;
  border-radius:5px;
  border:none;
  text-align:center;
}

button{
  padding:10px 20px;
  background:#00ffcc;
  border:none;
  border-radius:6px;
  font-size:16px;
  cursor:pointer;
}

#arena{
  margin:30px auto;
  width:300px;
  height:300px;
  border-radius:50%;
  background:#330000;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:22px;
  cursor:pointer;
  box-shadow:0 0 40px red;
  transition:0.3s;
}

.green{
  background:#003300 !important;
  box-shadow:0 0 60px #00ff00 !important;
}

.fake{
  background:#222 !important;
  box-shadow:0 0 40px orange !important;
}

.locked{
  background:#111 !important;
  box-shadow:0 0 60px red !important;
}

.leaderboard{
  background:#111;
  padding:15px;
  border-radius:10px;
  margin:20px auto;
  max-width:500px;
  text-align:left;
}

.leaderboard h2{color:gold;}
.hidden{display:none;}
</style>
</head>

<body>

<h1>üß† NEURO REACTION CHALLENGE</h1>

<div class="panel">
  <input id="name" placeholder="Player Name">
  <input id="age" placeholder="Age" type="number">
  <br><br>
  <button onclick="startTest()">START TEST</button>
</div>

<div id="arena">WAIT</div>

<div id="result"></div>

<div class="leaderboard">
  <h2>üèÜ TOP REACTIONS</h2>
  <ol id="board"></ol>
</div>

<script>
/* ---------- AUDIO SYSTEM (OFFLINE) ---------- */
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

function playSound(freq, duration, type="sine"){
  const osc = audioCtx.createOscillator();
  const gain = audioCtx.createGain();
  osc.type = type;
  osc.frequency.value = freq;
  osc.connect(gain);
  gain.connect(audioCtx.destination);
  gain.gain.value = 0.15;
  osc.start();
  osc.stop(audioCtx.currentTime + duration);
}

function alarmSound(){
  playSound(200,0.3,"square");
  setTimeout(()=>playSound(180,0.3,"square"),300);
}

function sirenSound(){
  let f=400;
  const id=setInterval(()=>{
    playSound(f,0.1,"sawtooth");
    f = f===400 ? 600 : 400;
  },150);
  setTimeout(()=>clearInterval(id),1500);
}

function successBeep(){
  playSound(800,0.2,"triangle");
}

/* ---------- GAME LOGIC ---------- */
let startTime;
let state="idle";
let timeout;
let leaderboard=[];

const arena=document.getElementById("arena");
const result=document.getElementById("result");

function loadBoard(){
  const data=localStorage.getItem("neuroBoard");
  if(data){leaderboard=JSON.parse(data);updateBoard();}
}

function updateBoard(){
  const board=document.getElementById("board");
  board.innerHTML="";
  leaderboard.slice(0,5).forEach(p=>{
    const li=document.createElement("li");
    li.textContent=`${p.name} (${p.age}) ‚Äì ${p.time} ms`;
    board.appendChild(li);
  });
}

function startTest(){
  audioCtx.resume();
  const name=document.getElementById("name").value.trim();
  const age=document.getElementById("age").value.trim();
  if(!name||!age){alert("Enter name and age");return;}

  result.textContent="";
  arena.textContent="WAIT";
  arena.className="";
  state="waiting";

  const delay=Math.random()*4000+2000;

  timeout=setTimeout(()=>{
    const fake=Math.random()<0.4;
    if(fake){
      arena.textContent="‚ö† FAKE SIGNAL";
      arena.classList.add("fake");
      state="fake";
      alarmSound();
    }else{
      arena.textContent="CLICK NOW";
      arena.classList.add("green");
      state="go";
      startTime=Date.now();
      successBeep();
    }
  },delay);
}

arena.onclick=()=>{
  if(state==="waiting"){
    fail("Too early! System locked.");
  }
  else if(state==="fake"){
    fail("Wrong signal! Test failed.");
  }
  else if(state==="go"){
    const time=Date.now()-startTime;
    success(time);
  }
};

function fail(msg){
  clearTimeout(timeout);
  arena.className="locked";
  arena.textContent="LOCKED";
  result.textContent="‚õî "+msg;
  result.style.color="red";
  sirenSound();
  state="idle";
}

function success(time){
  const name=document.getElementById("name").value;
  const age=document.getElementById("age").value;

  result.textContent=`‚úÖ SUCCESS! Reaction: ${time} ms`;
  result.style.color="lightgreen";
  successBeep();

  leaderboard.push({name,age,time});
  leaderboard.sort((a,b)=>a.time-b.time);
  localStorage.setItem("neuroBoard",JSON.stringify(leaderboard));
  updateBoard();
  state="idle";
}

loadBoard();
</script>

</body>
</html>
